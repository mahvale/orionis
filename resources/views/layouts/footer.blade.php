<footer id="footer-part">
    <div class="footer-top pt-40 pb-70">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6">
                    <div class="footer-about mt-40">
                        <div class="logo">
                            <a href="#">
                                <img src="/images/logo.png" style="width: 100px;height:100px;margin-left: 50px;border: 1px solid #fff;" alt="Logo"></a>
                        </div>
                        <p>Dans le monde actuel, où l'offre dépasse largement la demande sur de nombreux marchés.</p>
                    </div> <!-- footer about -->
                </div>
                
                <div class="col-lg-5 col-md-6 col-sm-6">
                    <div class="footer-link mt-40">
                        <div class="footer-title pb-25">
                            <h6 style="font-family: Times New Roman;">Plan du site</h6>
                        </div>
                        <ul>
                            <li><a href="/"><i class="fa fa-angle-right"></i>Accueil</a></li>
                            <li><a href="{{ url('propos') }}"><i class="fa fa-angle-right"></i>À propos</a></li>
                            <li><a href="/courses"><i class="fa fa-angle-right"></i>Assistance scolaire</a></li>
                        </ul>
                        <ul>
                            <li><a href="/prepas"><i class="fa fa-angle-right"></i>Prépas-concours</a></li>
                            <li><a href="orientation"><i class="fa fa-angle-right"></i>Orientation scolaire</a></li>
                        </ul>
                    </div> <!-- footer link -->
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="footer-address mt-40">
                        <div class="footer-title pb-25">
                            <h6 style="font-family: Times New Roman;">Nous contacter</h6>
                        </div>
                        <ul>
                            <li> 
                                <div class="icon">
                                    <i class="fa fa-home"></i>
                                </div>
                                <div class="cont">
                                    <p>WhatsApp : 696-15-91-03</p>
                                </div>
                            </li>
                            <li>
                                <div class="icon">
                                    <i class="fa fa-phone"></i>
                                </div>
                                <div class="cont">
                                    <p>+237 673-10-59-07</p>
                                    <p>+237 696-15-91-03</p>
                                </div>
                            </li>
                            <li>
                                <div class="icon">
                                    <i class="fa fa-envelope-o"></i>
                                </div>
                                <div class="cont">
                                    <p>orioniseducation@gmail.com</p>
                                </div>
                            </li>
                        </ul>
                    </div> <!-- footer address -->
                </div>
            </div> <!-- row -->
        </div> <!-- container -->
    </div> <!-- footer top -->

   <div class="footer-copyright py-2" style="background-color: #f8f9fa; border-top: 1px solid #e9ecef; border-bottom: 1px solid #e9ecef;">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-8 text-md-left text-center">
                <div class="copyright pt-2">
                    <p class="mb-0">
                        &copy; <a target="_blank" href="https://www.templateshub.net" style="text-decoration: none; color: #007bff;font-family: Times New Roman;text-transform: uppercase;">Orionis Educ-Services</a> 
                        - Tous droits réservés
                    </p>
                </div>
            </div>
            <div class="col-md-4 text-md-right text-center">
                <div class="social-icons pt-2">
                    <a href="#" class="me-2 mr-2" style="color: #007bff; text-decoration: none;font-family: Times New Roman;">
                         <div class="icon">
                            <img src="images/all-icon/ctg-2.png" style="width: 40px;height: 40px;" alt="icon">
                        </div>
                    </a>
                    <a href="#" class="me-2 mr-2" style="color: #007bff; text-decoration: none;font-family: Times New Roman;">
                        <div class="icon">
                            <img src="images/all-icon/ctg-3.png" style="width: 40px;height: 40px;" alt="icon">
                        </div>
                    </a>
                    <a href="#" style="color: #007bff; text-decoration: none;font-family: Times New Roman;">
                        <div class="icon">
                            <img src="images/all-icon/ctg-1.png" style="width: 40px;height: 40px;" alt="icon">
                        </div>
                    </a>
                </div>
            </div>
        </div> <!-- row -->
    </div> <!-- container -->
</div> <!-- footer copyright -->

</footer>
    <!--====== FOOTER PART ENDS ======-->
   
    <!--====== BACK TO TP PART START ======-->
    
    <a href="#" class="back-to-top"><i class="fa fa-angle-up"></i></a>
    
    <!--====== BACK TO TP PART ENDS ======-->
   
    
    
    
    
    
    
    
    <!--====== jquery js  ======-->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/popper.js"></script>
    <script src="/js/vendor/modernizr-3.6.0.min.js"></script>

    <!--====== Bootstrap js ======-->
    <script src="/js/bootstrap.min.js"></script>
    
    <!--====== Slick js ======-->
    <script src="/js/slick.min.js"></script>
    
    <!--====== Magnific Popup js  ======-->
    <script src="js/jquery.magnific-popup.min.js"></script>
    
    <!--====== Counter Up js ======-->
    <script src="/js/waypoints.min.js"></script>
    <script src="/js/jquery.counterup.min.js"></script>
    
    <!--====== Nice Select js ======-->
    <script src="/js/jquery.nice-select.min.js"></script>
    
    <!--====== Nice Number js ======-->
    <script src="/js/jquery.nice-number.min.js"></script>
    
    <!--====== Count Down js ======-->
    <script src="/js/jquery.countdown.min.js"></script>
    
    <!--====== Validator js ======-->
    <script src="/js/validator.min.js"></script>
    
    <!--====== Ajax Contact js ======-->
    <script src="/js/ajax-contact.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!--====== Main js ======-->
    <script src="/js/main.js"></script>
    <script src="/js/video.js"></script>
    <script src="/app.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <!--====== Map js ======-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://unpkg.com/lottie-web@latest/build/player/lottie.min.js"></script>

    <script src="/js/jquery-modal-video.min.js"></script>
    <script src="/js/pdf.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/simplemde/dist/simplemde.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.1/dist/aos.js"></script>
    @include('layouts.newfooter')
    @livewireScripts
    <script type="text/javascript">
  $(document).ready(function() {
    var CSRF_TOKEN = document.querySelector('meta[name="csrf-token"]').getAttribute("content");

   
 
        $('#search-cours').click(function(e) {
            e.preventDefault()
            let value = $("#inut-search").val()
             var formd = new FormData();
            formd.append('value',value);
            formd.append('_token',CSRF_TOKEN); 
            $.ajax({
                url: '{{route("search_matire")}}',
                type: 'POST',
                dataType: 'json',
                contentType: false,
                processData: false,
                data:formd,
            })
            .done(function(data) {
                console.log(data['html']);
                $('#row-cour').html(data['html'])
                $('.search-box').hide('400')
            })
            .fail(function(error) {
                console.log(error);
            })
            .always(function() {
                console.log("complete");
            });
            
        });

         $("#inut-search").autocomplete({
                source: function(request, response) {
                    $.ajax({
                        url: "{{route('search_maget')}}",
                        dataType: "json",
                        data: {
                            term: request.term
                        },
                        success: function(data) {
                            response(data);
                            console.log(data)
                        }
                    });
                },
                minLength: 2 // Nombre minimum de caractères avant de déclencher la recherche
            });

         // Fonction pour charger les chapitres en fonction du trimestre
    function loadChapters(trimestre) {
        $('#loader').show();  // Afficher le loader pendant le chargement

        let course_id = $('#course_id').val();
        let menu_tabs = $('#menu_tabs').val();
        console.log(menu_tabs)
        $.ajax({ 
            url: '/chapters/filter',  // Mettre à jour l'URL selon votre route
            method: 'GET',
            data: { trimestre: trimestre,course_id:course_id,menu_tabs:menu_tabs },
            success: function(response) {
                $('#loader').hide();  // Cacher le loader après le chargement
                if (menu_tabs == "cours") {$('#chapters-container').html(response); } // Mettre à jour les chapitres
                if (menu_tabs == "td") {$('#tds-container').html(response); } // Mettre à jour les chapitres
                if (menu_tabs == "tp") {$('#tps-container').html(response); } // Mettre à jour les chapitres
                if (menu_tabs == "exercices") {$('#exercices-container').html(response); } // Mettre à jour les chapitres
                if (menu_tabs == "evaluation") {$('#evaluation-container').html(response); } // Mettre à jour les chapitres
                // Mettre à jour la pagination et l'état des boutons
                $('.pagination .page-item').removeClass('active');  // Supprimer la classe active
                $('.pagination .page-link[data-trimestre="' + trimestre + '"]').closest('.page-item').addClass('active');
                
                // Gérer les boutons Previous et Next
                updateNavigationButtons(trimestre);
            },
            error: function(xhr, status, error) {
                $('#loader').hide();
                alert('Une erreur est survenue lors du chargement des chapitres.');
            }
        });
    }

    // Fonction pour mettre à jour l'état des boutons Previous et Next
    function updateNavigationButtons(trimestre) {
        var totalTrimestres = 3;  // Nombre total de trimestres

        // Désactiver le bouton Previous si on est au premier trimestre
        if (trimestre == 1) {
            $('.page-item-previous').addClass('disabled');
        } else {
            $('.page-item-previous').removeClass('disabled');
        }

        // Désactiver le bouton Next si on est au dernier trimestre
        if (trimestre == totalTrimestres) {
            $('.page-item-next').addClass('disabled');
        } else {
            $('.page-item-next').removeClass('disabled');
        }
    } 

    // Clic sur un trimestre spécifique
    $('.trimestre-link').on('click', function(e) {
        e.preventDefault();
        var tabs = $('#menu_tabs').val()
        var trimestre = $(this).data('trimestre');
        loadChapters(trimestre);
    });

    // Clic sur Previous
    $('.page-link-previous').on('click', function(e) {
        e.preventDefault();
        var currentTrimestre = $('.pagination .page-item.active .trimestre-link').data('trimestre');

        // Aller au trimestre précédent si possible
        if (currentTrimestre > 1) {
            loadChapters(currentTrimestre - 1);
        }
    });

    // Clic sur Next
    $('.page-link-next').on('click', function(e) {
        e.preventDefault();
        var currentTrimestre = $('.pagination .page-item.active .trimestre-link').data('trimestre');

        // Aller au trimestre suivant si possible
        if (currentTrimestre < 3) {
            loadChapters(currentTrimestre + 1);
        }
    });

    // Initialiser avec le premier trimestre et mettre à jour l'état des boutons
    updateNavigationButtons(1);

         $('.trimestre-link').on('click', function(e) {
        e.preventDefault();

        // Récupérer le numéro du trimestre
        var trimestre = $(this).data('trimestre');
        let course_id = $('#course_id').val();
        // Afficher le loader
        $('#loader').show();

        // Envoyer une requête AJAX pour récupérer les chapitres du trimestre sélectionné
        $.ajax({
            url: '/chapters/filter',  // Remplacez par l'URL correcte
            method: 'GET',
            data: { trimestre: trimestre,course_id:course_id },
            success: function(response) {
                // Masquer le loader
                $('#loader').hide();

                // Mettre à jour le conteneur avec les chapitres filtrés
                $('#chapters-container').html(response);

                // Gestion de la classe 'active'
                // Supprimer la classe 'active' de tous les items de pagination
                $('.pagination .page-item').removeClass('active');

                // Ajouter la classe 'active' à l'élément parent du lien cliqué
                $(e.target).closest('.page-item').addClass('active');
            },
            error: function(xhr, status, error) {
                // Masquer le loader en cas d'erreur
                $('#loader').hide();

                // Gérer les erreurs
                alert('Une erreur est survenue lors du chargement des chapitres.');
            }
        });
    });
        
$('#search-button-detail').on('click', function () {
    let query = $('#search-input-detail').val();
    let course_id = $('#course_id').val();
    let activeTab = $('div.tab-pane.active').attr('id');  // Identifie l'onglet actif 

    if (query.trim() !== '') {
        // Afficher le loader
        $('#loader').show();

        $.ajax({
            url: '/search',  // URL pour la recherche
            type: 'GET',
            data: {
                query: query,
                tab: activeTab,  // Envoie l'onglet actif avec la requête
                course_id: course_id,
            },
            success: function (data) {
                console.log(data);
                $('#' + activeTab).html(data);

                // Masquer le loader
                $('#loader').hide();
            },
            error: function () {
                console.log('Erreur lors de la recherche');

                // Masquer le loader en cas d'erreur
                $('#loader').hide();
            }
        });
    }
});



        $('#send').click(function () {
                var message = $('#message').val();

                // Envoi d'une requête AJAX vers Laravel
                $.ajax({
                    url: '/chatbot',
                    type: 'POST',
                    data: {
                        message: message,
                        _token: "{{ csrf_token() }}"  // Laravel CSRF Token
                    },
                    success: function (response) {
                        console.log(response)
                        $('#response').html('<p>Chatbot : ' + response.choices[0].message.content + '</p>');
                    },
                    error: function () {
                        $('#response').html('<p>Erreur lors de la communication avec l\'API.</p>');
                    }
                });
            });


          $('#uploadModal').on('click', '#file-upload', function () {
        $(this).click();
    });

            // Handle file selection and preview
    $('#file-upload').change(function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                $('#file-preview').html(`<img src="${e.target.result}" alt="${file.name}" class="img-fluid">`);
            };
            reader.readAsDataURL(file);
        }
         $('#uploadModal').modal('show');
    });

         $('#send-btn').click(function () {
        const comment = $('#comment').val();
        const file = $('#file-upload')[0].files[0];
        const course_id = $('#course_id').val();

        $.ajaxSetup({
                headers: {
                    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                }
            });
        
        const formData = new FormData();
        formData.append('comment', comment);
        if (file) {
            formData.append('file', file);
            formData.append('course_id', course_id);
            formData.append('_token', $('meta[name="csrf-token"]').attr('content'));
        }

        $.ajax({
            url: '/upload', // Adjust this to your upload route
            method: 'POST',
            data: formData,
            contentType: false,
            processData: false,
            success: function (response) {
                // Handle success (e.g., show a success message)
                alert('File uploaded successfully!');
                $('#uploadModal').modal('hide');
                $('#comment').val(''); // Clear the comment
                $('#file-preview').html(''); // Clear the preview
            },
            error: function (xhr) {
                // Handle error (e.g., show an error message)
                alert('Error uploading file: ' + xhr.responseText);
                console.log('Error uploading file: ' + xhr.responseText);
            }
        });

    });

     

    
           $("#search-input").autocomplete({
                source: function(request, response) {
                    $.ajax({
                        url: "{{ route('courses.search') }}",
                        dataType: "json",
                        data: {
                            query: request.term
                        },
                        success: function(data) {
                            response(data);
                        }
                    });
                }
            }); 

    $('#search-button').click(function() {
            var query = $('#search-input').val();
            
            $.ajax({
                url: "{{ route('search2.courses2') }}", // Update this with your route
                method: 'GET',
                data: {
                    query: query
                },
                success: function(data) {
                    $('#courses-part').html(data);
                },
                error: function(xhr) {
                    $('#courses-part').html('<p>An error occurred while fetching the data.</p>');
                }
            });
        });
         let selectedRating = 0;

 /*   $('.star').hover(function() {
        const value = $(this).data('value');
        $('.star').each(function() {
            $(this).toggleClass('selected', $(this).data('value') <= value);
        });
    });*/

 $('.star').click(function() {
    const selectedRating = $(this).data('value');
    const chapterId = $(this).closest('.rating').data('chapter-id');
console.log(selectedRating)
    // Reset all stars in the same chapter
    $('.rating[data-chapter-id="' + chapterId + '"] .star').removeClass('selected');
    $('.submitRating[data-chatId="' + chapterId + '"]').attr('data-selectedRating', selectedRating);
   
    // Set the selected stars
    $('.rating[data-chapter-id="' + chapterId + '"] .star').each(function() {
        $(this).toggleClass('selected', $(this).data('value') <= selectedRating);
    });


});

  $('.startd').click(function() {
    const selectedRating = $(this).data('value');
    const chapterId = $(this).closest('.rating').data('chapter-id');

    // Reset all stars in the same chapter
    $('.rating[data-chapter-id="' + chapterId + '"] .startd').removeClass('selected');
    $('.submitRatingTd[data-chatId="' + chapterId + '"]').attr('data-selectedRating', selectedRating);
   
    // Set the selected stars submitRating
    $('.rating[data-chapter-id="' + chapterId + '"] .startd').each(function() {
        $(this).toggleClass('selected', $(this).data('value') <= selectedRating);
    });


});

  $('.startp').click(function() {
    const selectedRating = $(this).data('value');
    const chapterId = $(this).closest('.rating').data('chapter-id');

    // Reset all stars in the same chapter
    $('.rating[data-chapter-id="' + chapterId + '"] .startd').removeClass('selected');
    $('.submitRatingTp[data-chatId="' + chapterId + '"]').attr('data-selectedRating', selectedRating);
   
    // Set the selected stars submitRating
    $('.rating[data-chapter-id="' + chapterId + '"] .startp').each(function() {
        $(this).toggleClass('selected', $(this).data('value') <= selectedRating);
    });


});


$('.submitRating').click(function() {
    let selectedRating = $(this).attr('data-selectedRating');
    console.log(selectedRating);
    if (selectedRating > 0) {
        let chapter_id = $(this).attr('data-chatId');
        $.ajax({
            url: '/submit-rating',
            method: 'POST', // Assurez-vous que la méthode est POST
            data: {
                rating: selectedRating,
                chapter_id: chapter_id,
                _token: $('meta[name="csrf-token"]').attr('content')  // Assurez-vous que le CSRF token est inclus
            },
            success: function(response) {
                console.log(response);
                $('#averageRating').text(`Note moyenne: ${response.averageRating}`);
                $('#totalRatings').text(`Total des avis: ${response.totalRatings}`);

                // Remplacer le toast par une alerte
                alert(response.message); // Afficher le message dans une alerte
            },
            error: function(xhr, status, error) {
                console.error(error);
                alert('Une erreur s\'est produite lors de l\'envoi de votre avis.');
            }
        });
    } else {
        console.log("rrffjj")
        alert('Veuillez sélectionner une note.');
    }
});


$('.submitRatingTp').click(function() {
    let selectedRating = $(this).attr('data-selectedRating');
    console.log(selectedRating);
    if (selectedRating > 0) {
        let tp_id = $(this).attr('data-chatId');
        $.ajax({
            url: '/submit-ratingtp',
            method: 'POST', // Assurez-vous que la méthode est POST
            data: {
                rating: selectedRating,
                tp_id: tp_id,
                _token: $('meta[name="csrf-token"]').attr('content')  // Assurez-vous que le CSRF token est inclus
            },
            success: function(response) {
                console.log(response);
                $('#averageRatingTp').text(`Note moyenne: ${response.averageRatingTp}`);
                $('#totalRatingsTp').text(`Total des avis: ${response.totalRatingsTp}`);

                // Remplacer le toast par une alerte
                alert(response.message); // Afficher le message dans une alerte
            },
            error: function(xhr, status, error) {
                console.error(error);
                alert('Une erreur s\'est produite lors de l\'envoi de votre avis.');
            }
        });
    } else {
        alert('Veuillez sélectionner une note.');
    }
});

$('.submitRatingTd').click(function() {
    let selectedRating = $(this).attr('data-selectedRating');
    console.log(selectedRating);
    if (selectedRating > 0) {
        let td_id = $(this).attr('data-chatId');
        $.ajax({
            url: '/submit-ratingtd',
            method: 'POST', // Assurez-vous que la méthode est POST
            data: {
                rating: selectedRating,
                td_id: td_id,
                _token: $('meta[name="csrf-token"]').attr('content')  // Assurez-vous que le CSRF token est inclus
            },
            success: function(response) {
                console.log(response);
                $('#averageRatingTd').text(`Note moyenne: ${response.averageRatingTd}`);
                $('#totalRatingsTd').text(`Total des avis: ${response.totalRatingsTd}`);

                // Remplacer le toast par une alerte
                alert(response.message); // Afficher le message dans une alerte
            },
            error: function(xhr, status, error) {
                console.error(error);
                alert('Une erreur s\'est produite lors de l\'envoi de votre avis.');
            }
        });
    } else {
        alert('Veuillez sélectionner une note.');
    }
});


 
     $('.avis').each(function(index, el) {
       const courseTitle =  $(el).attr('data-avis');
       $.get(`/ratings/${courseTitle}`, function(data) {
           //$(el).text(`(${data} Avis)`)
        });
     });

        $('.chapterRating').each(function(index, el) {
       const chapterId =  $(el).attr('data-chapterRating');
       $.get(`/chapters/${chapterId}`, function(data) {
          $(el).html(data)
        
        });
     });

         $('.reviewCount').each(function(index, el) {
       const chapterId =  $(el).attr('data-chapterRating');
       $.get(`/reviewCount/${chapterId}`, function(data) {
         $(el).html(`(${data} Avis)`)
        
        });
     });

               $('.reviewCounttd').each(function(index, el) {
       const chapterId =  $(el).attr('data-chapterRating');
       $.get(`/reviewCounttd/${chapterId}`, function(data) {
         $(el).html(`(${data} Avis)`)
        
        });
     });


     $('.reviewCounttp').each(function(index, el) {
        console.log(el)
       const chapterId =  $(el).attr('data-chapterRating');
       $.get(`/reviewCounttp/${chapterId}`, function(data) {
         $(el).html(`(${data} Avis)`)
        
        });
     });

        $('.avis').each(function(index, el) {
       const courseTitle =  $(el).attr('data-avis');
       $.get(`/ratings_moyenne/${courseTitle}`, function(data) {
        console.log(data)
          let rating = parseInt(data)
         for (var i = 0; i < rating; i++) {
              let element = $(el).parent().children()
              $(element[0]).append('<span class="text-warning"><i class="fa fa-star"></i></span>')
          }
            
        });
     });

       // Configuration pour charger la vidéo locale
// Détacher d'abord tout événement précédent avant de l'attacher à nouveau
// Initialisation de la modal seulement une fois au chargement de la page
$('.js-video-button').modalVideo({
    channel: 'custom',  // Spécifie un canal personnalisé pour les vidéos locales
});

// Gestionnaire de clic
$(".js-video-button").on("click", function(e) {
    e.stopPropagation(); // Empêche la propagation de l'événement

    var videoUrl = $(this).data('video-url'); // Récupérer l'URL de la vidéo

    // Fermer toute modal existante avant d'en ouvrir une nouvelle
    if ($(".modal-video").hasClass("modal-video-active")) {
        // Si une modale est déjà active, la fermer
        $(".modal-video").removeClass("modal-video-active");
        $(".modal-video").fadeOut();
    }

    // Ouvrir la nouvelle vidéo
    $(this).modalVideo({
        channel: 'custom',  // Spécifie un canal personnalisé pour les vidéos locales
        url: videoUrl       // Utilisez l'URL locale de la vidéo
    });
});





       
      /*  $('.js-pdf-button').click(function(e) {
            e.preventDefault()
            let pdf = encodeURIComponent($(this).attr('data-pdf-url'));
            let title = $(this).attr('data-pdf-title');
            console.log(pdf)
           location.href = `/fichier/${pdf}/${title}` 
        });*/

    $('.js-pdf-button').click(function(e) {
    e.preventDefault();
    let pdf = $(this).attr('data-pdf-url');
    let title = $(this).attr('data-pdf-title');
    let external_file = $(this).attr('data-external_file');
    console.log(pdf);
    if (external_file == 0) {
        location.href = `/fichier/${pdf}/${title}`
    } else {
        location.href = `/fichier_external_file?pdf=${encodeURIComponent(pdf)}&title=${title}`;
    }
    
});


        $('.js-pdf-corrections-button ').click(function(e) {
    e.preventDefault();
    let pdf = $(this).attr('data-pdf-url');
    let title = $(this).attr('data-pdf-title');
    let external_file = $(this).attr('data-external_file');
    console.log(pdf);
    if (external_file == 0) {
        location.href = `/fichier_corrections/${pdf}/${title}`
    } else {
        location.href = `/fichier_external_file?pdf=${encodeURIComponent(pdf)}&title=${title}`;
    }
    
});


     $('.js-pdf-button-exercise').click(function(e) {
    e.preventDefault();
    let pdf = $(this).attr('data-pdf-url');
    let title = $(this).attr('data-pdf-title');
    let external_file = $(this).attr('data-external_file');
    let exercise = $(this).attr('data-pdf-idexercise');
    console.log(pdf);
    if (external_file == 0) {
        location.href = `/fichier_exercise/${pdf}/${title}/${exercise}`
    } else {
        location.href = `/fichier_external_file?pdf=${encodeURIComponent(pdf)}&title=${title}`;
    }
    
});


     
$(document).on('click', '.js-pdf-exams-button', function(e) {
    e.preventDefault();
    let pdf = $(this).attr('data-pdf-url');
    let title = $(this).attr('data-pdf-title');
    let external_file = $(this).attr('data-external_file');
    let exercise = $(this).attr('data-pdf-idexercise');
    console.log(pdf);
    if (external_file == 0) {
        location.href = `/fichier_exams/${pdf}/${title}/${exercise}`;
    } else {
        location.href = `/fichier_external_file?pdf=${encodeURIComponent(pdf)}&title=${title}`;
    }
});



        $('.js-exercice-button').click(function(e) {
            e.preventDefault()
            let pdf = $(this).attr('data-pdf-url');
            let title = $(this).attr('data-pdf-title');
            let correction = $(this).attr('data-correction');
            console.log(pdf)
            if (correction == undefined) {
                location.href = `/exercice/${pdf}/${title}/0`
            } else {
                location.href = `/exercice/${pdf}/${title}/${correction}`
            }
           //location.href = `/exercice/${pdf}/${title}`
        });

        // Lorsque l'utilisateur clique sur le bouton audio// Lorsque l'utilisateur clique sur le bouton audio
$(".js-audio-button").click(function() {
    var audioUrl = $(this).data('audio-url'); // Récupère l'URL locale du fichier audio
    console.log($('#menu_tabs').val())
    // Met à jour la source de l'audio
    $("#audioSource").attr("src", audioUrl);
    $("#audioPlayer")[0].load();  // Recharge l'élément audio avec la nouvelle source

    // Affiche la modal Bootstrap avec l'audio
    $("#audioModal").modal('show');
});

// Arrêter l'audio lorsque la modal est fermée
$('#audioModal').on('hidden.bs.modal', function () {
    var audioPlayer = $("#audioPlayer")[0];  // Sélectionne l'élément audio
    audioPlayer.pause();  // Met en pause l'audio
    audioPlayer.currentTime = 0;  // Remet l'audio au début
});
  


      });
    </script>
<!--Start of Tawk.to Script  <li><a href="#"><i class="fa fa-facebook-f"></i></a></li> -->
<!-- <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
    var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
    s1.async=true;
    s1.src='https://embed.tawk.to/66e2d4caea492f34bc1264fc/1i7j0ueb7';
    s1.charset='UTF-8';
    s1.setAttribute('crossorigin','*');
    s0.parentNode.insertBefore(s1,s0);
    })();
    </script> -->
    <!-- End of Tawk.to Script-->
   <script>
        // Initialize Lottie Animation
        var animation = lottie.loadAnimation({
            container: document.getElementById('animation-container'), // the DOM element
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: '/animation.json' // path to the animation JSON
        });
    </script> 
    <script>
    // JavaScript to handle the video modal
   /* document.querySelectorAll('.js-video-button').forEach(button => {
        button.addEventListener('click', function() {
            const videoUrl = this.getAttribute('data-video-url');
            const videoFrame = document.getElementById('videoFrame');
             $('#videoModal').modal('show');
            videoFrame.src = videoUrl; // Set the video URL in the iframe
            console.log('object')
        });
    });*/

    // Reset the video when modal is hidden
    const videoModal = document.getElementById('videoModal');
    videoModal.addEventListener('hidden.bs.modal', function () {
        const videoFrame = document.getElementById('videoFrame');
        videoFrame.src = ""; // Clear the video source
    });
</script>
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', () => {
        // Gestion de l'affichage des réponses
        document.querySelectorAll('.show-responses').forEach(button => {
            button.addEventListener('click', () => {
                const responsesDiv = button.nextElementSibling;
                responsesDiv.style.display = responsesDiv.style.display === 'none' ? 'block' : 'none';
                const form = responsesDiv.querySelector('.response-form');
                console.log(form.style.display)
                form.style.display = form.style.display === 'none' ? 'block' : 'none';
            });
        });

        // Soumission du formulaire de création de post
        document.querySelector('.post-form').addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData(event.target);

            fetch(event.target.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                }
            })
            .then(response => response.json()) 
            .then(data => {
                // Ajoutez le nouveau post au forum
                const forumContainer = document.getElementById('forum');
                const newPost = `<div class="border p-3 mb-3 rounded">
                                    <p class="font-weight-bold">${data.content} ( ${data.profName} )</p>
                                    <button class="btn btn-link show-responses text-warning" style="font-family:Times New Roman ;"> réponses</button>
                                    <div class="responses" style="display: none;">
                                        <!-- Les réponses seront ajoutées ici -->
                                    </div>
                                    <div class="mb-2">
                                        <button class="btn btn-outline-success like-button">👍 J'aime</button>
                                        <button class="btn btn-outline-danger dislike-button">👎 Pas J'aime</button>
                                    </div>
                                </div>`;
                forumContainer.insertAdjacentHTML('beforeend', newPost);
                event.target.reset(); // Réinitialise le formulaire
            });
        });

        // Soumission du formulaire de réponse
        document.querySelectorAll('.response-form').forEach(form => {
            form.addEventListener('submit', (event) => {
                event.preventDefault();
                const formData = new FormData(event.target);

                fetch(event.target.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                    }
                })
                .then(response => response.json())
                .then(data => {
                    // Ajoutez la nouvelle réponse au post
                    const responsesDiv = form.parentElement;
                    const newResponse = `<div class="border-left pl-3 mb-1">
                                            <p>${data.content} (${data.user.name})</p>
                                        </div>`;
                    responsesDiv.insertAdjacentHTML('afterbegin', newResponse);
                    form.reset(); // Réinitialise le formulaire de réponse
                });
            });
        });
    });

document.querySelectorAll('.like-button').forEach(button => {
    button.addEventListener('click', () => {
        const postId = button.getAttribute("data-postId");
        fetch(`/posts/${postId}/like`, {
            method: 'POST',
            headers: {
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        })
        .then(response => response.json())
        .then(data => {
            button.classList.add('active');
        });
    });
});

document.querySelectorAll('.dislike-button').forEach(button => {
    button.addEventListener('click', () => {
        const postId = button.closest('.border').dataset.postId;

        fetch(`/posts/${postId}/dislike`, {
            method: 'POST',
            headers: {
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        })
        .then(response => response.json())
        .then(data => {
            button.classList.add('active');
        });
    });
});

document.querySelectorAll('.mark-correct-button').forEach(button => {
    button.addEventListener('click', () => {
        const responseId = button.getAttribute('data-responseId');

        fetch(`/responses/${responseId}/mark-correct`, {
            method: 'POST',
            headers: {
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        })
        .then(response => response.json())
        .then(data => {
            // Change response appearance
            button.closest('.border-left').classList.add('bg-success', 'text-white'); // Mark as correct
            button.closest('.border-left').classList.remove('bg-danger'); // Remove any incorrect styling
            button.closest('.border-left').querySelectorAll('.mark-correct-button, .mark-incorrect-button').forEach(btn => btn.remove()); // Remove buttons
        });
    });
});

document.querySelectorAll('.mark-incorrect-button').forEach(button => {
    button.addEventListener('click', () => {
        const responseId = button.getAttribute('data-responseId');

        fetch(`/responses/${responseId}/mark-incorrect`, {
            method: 'POST',
            headers: {
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        })
        .then(response => response.json())
        .then(data => {
            // Change response appearance
            button.closest('.border-left').classList.add('bg-danger', 'text-white'); // Mark as incorrect
            button.closest('.border-left').classList.remove('bg-success'); // Remove any correct styling
            button.closest('.border-left').querySelectorAll('.mark-correct-button, .mark-incorrect-button').forEach(btn => btn.remove()); // Remove buttons
        });
    });



});

</script>

</body>
</html>
